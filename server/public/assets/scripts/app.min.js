/*! 2015-12-04 */
function getData(){$.ajax({type:"GET",url:"/data",dataType:"json",success:function(a){globaldata=a,console.log("I got the data",globaldata),addDataToMap(globaldata)}})}function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:44.87608,lng:-93.329406},zoom:10})}function addDataToMap(a){for(var b=0;b<a.length;b++)console.log("in le loop",a[b]),map.data.addGeoJson(a[b]);console.log("Look at me! This is the format the data is in when the annotations on the map are loaded",a);var c=new google.maps.InfoWindow;map.data.addListener("click",function(a){var b=a.feature.getProperty("name"),d=a.feature.getProperty("address");c.setContent("<div style='width:150px; text-align: center;'>"+b+" <br>"+d+"</div>"),c.setPosition(a.feature.getGeometry().get()),c.setOptions({pixelOffset:new google.maps.Size(0,-30)}),c.open(map)})}function geolocationBtn(){$("#currentLocation").on("click",function(){function a(a,b,c){b.setPosition(c),b.setContent(a?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation.")}console.log("click happened");var b=new google.maps.InfoWindow({map:map});navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){var b={lat:a.coords.latitude,lng:a.coords.longitude};map.setCenter(b),map.setZoom(12)},function(){a(!0,b,map.getCenter())}):a(!1,b,map.getCenter())})}function initialize(){geocoder=new google.maps.Geocoder}function areaSearch(){event.preventDefault();var a={};$.each($(this).serializeArray(),function(b,c){console.log("field in searchKeyword",c),a[c.name]=c.value});var b=a.station_search;$("#areaSearch").find("input[type=text]").val(""),console.log("this is values in search",b),geocoder.geocode({address:b},function(a,b){if(b==google.maps.GeocoderStatus.OK){console.log("Everythings a okay!"),console.log(a);var c=[];c[0]=a[0].geometry.location.lat(),c[1]=a[0].geometry.location.lng();var d={lng:c[1],lat:c[0]};console.log(d),map.setCenter(d),map.setZoom(12)}else alert("Geocode was not successful for the following reason: "+b)})}var globaldata=[],map,geocoder;$(document).ready(function(){console.log("Up and running!"),initMap(),getData(),geolocationBtn(),initialize(),$("#areaSearch").submit(areaSearch)});